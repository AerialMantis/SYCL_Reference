image: rscohn2/oneapi-spec:latest

before_script:
  - python3 -m venv venv
  - . venv/bin/activate
  - pip install --upgrade --quiet -r requirements.txt

test:
  stage: test
  script:
  - python doc.py html
  - python doc.py latexpdf
  - python doc.py spelling
  artifacts:
    paths:
    - build
  except:
  - master
  
pages:
  stage: deploy
  script:
  - python doc.py html
  - python doc.py latexpdf
  - python doc.py spelling
  - cp -r build/html public
  artifacts:
    paths:
    - public
    - build
  only:
  - master
